<?xml version="1.0" encoding="UTF-8"?>
<FlowConfiguration>
	<id>meteosat</id>
	<description>Flow for Meteosat</description>
	<name>meteosat</name>
	
	<corePoolSize>5</corePoolSize>
	<maximumPoolSize>10</maximumPoolSize>
	<keepAliveTime>3600</keepAliveTime> <!--seconds-->
	<workQueueSize>100</workQueueSize>
	
	<autorun>true</autorun>
	
	<EventConsumerConfiguration>
	
		<id>id</id>
		
		<performBackup>false</performBackup>
		
		<listenerId>Logger</listenerId>
		<listenerId>Cumulator</listenerId>
		
		<ScriptingConfiguration>
			<id>MeteosatScript</id>
			<description>Groovy Script</description>
			<name>meteosat_script</name>
			
			<listenerId>Logger</listenerId>
			<listenerId>StatusAction</listenerId>
			
			<serviceID>ScriptingService</serviceID>

			<language>groovy</language>
			<scriptFile>meteosat.groovy</scriptFile>
			<properties>
				  <!-- xml template for translate-->
				  <entry>
				    <string>ENV_FILE</string>
				    <!--relative to the confDir dir-->
				    <string>env.properties</string>
				  </entry>
				  <entry>
				    <string>WORKSPACE</string>
				    <string>lamma</string>
				  </entry>
				  
				  <entry>
				    <string>GSPWD</string>
				    <string>geoserver</string>
				  </entry>
				  <entry>
				    <string>GSUID</string>
				    <string>admin</string>
				  </entry>
				  <entry>
				    <string>GSURL</string>
				    <string>http://localhost:8181/geoserver/</string>
				  </entry>
				  
				  <entry>
				    <string>GNPWD</string>
				    <string>admin</string>
				  </entry>
				  <entry>
				    <string>GNUID</string>
				    <string>admin</string>
				  </entry>
				  <entry>
				    <string>GNURL</string>
				    <string>http://localhost:8282/geonetwork/</string>
				  </entry>
				  <entry>
				    <string>GN_METADATA_TEMPLATE</string>
				    <string>gn_template.xml</string>
				  </entry>
				  
				  
				  <entry>
				    <string>GSTPWD</string>
				    <string>admin</string>
				  </entry>
				  <entry>
				    <string>GSTUID</string>
				    <string>admin</string>
				  </entry>
				  <entry>
				    <string>GSTURL</string>
				    <string>http://localhost:8383/geostore/rest/</string>
				  </entry>
				  <entry>
				    <string>GST_METADATA_TEMPLATE</string>
				    <string>gst_template.js</string>
				  </entry>
				  
				  
				  <entry>
				    <string>PREFIX_LIST</string>
				    <string>AIRMASS,NatColours,Dust,Channel_1</string>
				  </entry>
				  
				  <!-- AIRMASS -->
				  <entry>
				    <string>AIRMASS_FILTER</string>
				    <string>*_WV_062_05*,*_WV_073_06*,*_IR_097_08*,*_IR_108_09*</string>
				  </entry>
				  <entry>
				    <string>AIRMASS_CALC</string>
				    <string>airmass</string>
				  </entry>
				  <entry>
				    <string>AIRMASS_SCRIPT</string>
				    <string>createRGB_2.py</string>
				  </entry>
				  <entry>
				    <string>AIRMASS_MOSAIC_DIR</string>
				    <string>/home/carlo/work/data/METEOSAT/Airmass</string>
				  </entry>
				  
				  <!-- NatColours -->
				  <entry>
				    <string>NatColours_FILTER</string>
				    <string>*_VIS006_01*,*_VIS008_02*,*_IR_016_03*</string>
				  </entry>
				  <entry>
				    <string>NatColours_CALC</string>
				    <string>NatColours</string>
				  </entry>
				  <entry>
				    <string>NatColours_SCRIPT</string>
				    <string>createRGB_2.py</string>
				  </entry>
				  <entry>
				    <string>NatColours_MOSAIC_DIR</string>
				    <string>/home/carlo/work/data/METEOSAT/NatColours</string>
				  </entry>
				  
				  <!-- Dust -->
				  <entry>
				    <string>Dust_FILTER</string>
				    <string>*_IR_087_07*,*_IR_108_09*,*_IR_120_10*</string>
				  </entry>
				  <entry>
				    <string>Dust_CALC</string>
				    <string>Dust</string>
				  </entry>
				  <entry>
				    <string>Dust_SCRIPT</string>
				    <string>createRGB_2.py</string>
				  </entry>
				  <entry>
				    <string>Dust_MOSAIC_DIR</string>
				    <string>/home/carlo/work/data/METEOSAT/Dust</string>
				  </entry>
				  
				  <!-- Channel_1 -->
				  
				  <entry>
				    <string>Channel_1_FILTER</string>
				    <string>*_WV_062_05*</string>
				  </entry>
				  <!--entry>
				    <string>_CALC</string>
				    <string></string>
				  </entry>
				  <entry>
				    <string>_SCRIPT</string>
				    <string></string>
				  </entry-->
				  <entry>
				    <string>Channel_1_MOSAIC_DIR</string>
				    <string>/home/carlo/work/data/METEOSAT/Channel_1</string>
				  </entry>
				  
				  
				  <!--entry>
				    <string>_FILTER</string>
				    <string></string>
				  </entry>
				  <entry>
				    <string>_CALC</string>
				    <string></string>
				  </entry>
				  <entry>
				    <string>_SCRIPT</string>
				    <string></string>
				  </entry>
				  <entry>
				    <string>_STYLE</string>
				    <string></string>
				  </entry>
				  <entry>
				    <string>_MOSAIC_DIR</string>
				    <string></string>
				  </entry-->
				  
			</properties>
		</ScriptingConfiguration>
		
	</EventConsumerConfiguration>
	<EventGeneratorConfiguration>
		<wildCard>*.*</wildCard>
		<watchDirectory>meteosat/in</watchDirectory>
		<osType>OS_UNDEFINED</osType>
		<eventType>FILE_ADDED</eventType>

                  <!-- CRON: every 30 secs -->
                  <interval>*/10 * * * * ?</interval>

		<id>id</id>
		<serviceID>fsEventGeneratorService</serviceID>
	</EventGeneratorConfiguration>
	
	<ListenerConfigurations>
		<LoggingProgressListener>
			<serviceID>loggingListenerService</serviceID>
			<id>Logger</id>
			<loggerName>it.geosolutions.geobatch</loggerName>
		</LoggingProgressListener>
		
		<CumulatingProgressListener>
			<serviceID>cumulatingListenerService</serviceID>
			<id>Cumulator</id>
		</CumulatingProgressListener>
		
		<StatusProgressListener>
			<serviceID>statusListenerService</serviceID>
			<id>StatusAction</id>
		</StatusProgressListener>
		
	</ListenerConfigurations>
	
</FlowConfiguration>
